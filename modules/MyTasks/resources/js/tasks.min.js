$(document).ready(function(){function a(){$("input[name=txtTaskName]").val(""),$("textarea[name=txtTaskDesc]").val(""),$("#dataInicio").val(""),$("#dataFim").val(""),$("#horaInicio").val(""),$("#minutoInicio").val(""),$("#horaFim").val(""),$("#minutoFim").val("")}function t(){$.ajax({url:"modules/MyTasks/php/carregaTarefas.php",type:"POST",data:{userId:e},success:function(a){for(var t=$.parseJSON(a),i=0;i<t.length;i++)1!=t[i].taskStatus&&o.append("<tr id = "+t[i].id+"><td>"+t[i].taskName+"</td><td>"+t[i].desc+"</td><td>"+t[i].dataInicio+" "+t[i].horaInicio+":"+t[i].minutoInicio+"</td><td>"+t[i].dataFim+" "+t[i].horaFim+":"+t[i].minutoFim+"</td></tr>")}})}function i(){$.ajax({url:"modules/MyTasks/php/carregaTarefas.php",type:"POST",data:{userId:e},success:function(a){for(var t=$.parseJSON(a),i=0;i<t.length;i++)1==t[i].taskStatus&&o.append("<tr id = "+t[i].id+" class = 'done'><td>"+t[i].taskName+"</td><td>"+t[i].desc+"</td><td>"+t[i].dataInicio+" "+t[i].horaInicio+":"+t[i].minutoInicio+"</td><td>"+t[i].dataFim+" "+t[i].horaFim+":"+t[i].minutoFim+"</td></tr>")}})}var o=$("#taskList");$("#deleteDialog").hide(),$("#deleteDialogSelected").hide(),$("#doneDialog").hide(),$("#alreadyDoneDialog").hide(),$("#addTaskForm").hide(),$("#addGroupForm").hide(),o.hide(),$("#typeUndone").addClass("activeTaskTypeUndone");var e=($("#dataInicio").val(),$("#dataFim").val(),$("input[name=userId]").val());t(),$("#dataInicio").datepicker({altFormat:"dd/mm/yyy",dateFormat:"dd/mm/yy",showOtherMonths:!0,selectOtherMonths:!0,changeMonth:!0,changeYear:!0}),$("#dataFim").datepicker({altFormat:"dd/mm/yy",dateFormat:"dd/mm/yy",showOtherMonths:!0,selectOtherMonths:!0,changeMonth:!0,changeYear:!0}),$(document).ajaxStart(function(){$(".loader").show()}),$(document).ajaxStop(function(){$(".loader").hide(),o.show()}),$("#addTask").on("click",function(){$("#btnAddTask span").html("Adicionar"),$("input[name=taskId]").val(""),a(),$("#addTaskForm").dialog({modal:!0,show:{effect:"slideDown",duration:600},width:500})}),$("#btnCancelTaskForm").on("click",function(){$("#addTaskForm").dialog("destroy")}),$(".taskList").on("click","tr:not(:first-child)",function(){$(this).hasClass("highlighted")?$(this).removeClass("highlighted"):$(this).hasClass("done")?($(this).removeClass("done"),$(this).addClass("highlighted2")):$(this).hasClass("highlighted2")?($(this).removeClass("highlighted2"),$(this).addClass("done")):$(this).addClass("highlighted")}),$("#removeTask").on("click",function(){var a=0,t=[];$(".highlighted, .highlighted2").each(function(){t[a]=$(this).attr("id"),a++}),t.length>0?$("#deleteDialog").dialog({resizable:!1,height:140,width:500,modal:!0,buttons:{Sim:function(){var a=0,t=[];$(".highlighted, .highlighted2").each(function(){$(this).remove(),t[a]=$(this).attr("id"),a++}),$.ajax({type:"POST",url:"modules/MyTasks/php/deletaTarefas.php",data:{tasks:t},success:function(){}}),$(this).dialog("close")},Cancelar:function(){$(this).dialog("close")}}}):$("#deleteDialogSelected").dialog({modal:!0,buttons:{Ok:function(){$(this).dialog("close")}}})}),$("#btnAddTask").on("click",function(){var a=$("input[name=taskId]").val(),t=$("input[name=txtTaskName]").val(),i=$("textarea[name=txtTaskDesc]").val(),d=$("#dataInicio").val(),n=$("#dataFim").val(),s=$("#horaInicio").val(),h=$("#minutoInicio").val(),l=$("#horaFim").val(),c=$("#minutoFim").val();""==t?alert("Favor informe o nome da tarefa."):$.ajax({type:"POST",url:"modules/MyTasks/php/addTask.php",data:{taskId:a,taskName:t,taskDesc:i,dataInicio:d,dataFim:n,horaInicio:s,minutoInicio:h,horaFim:l,minutoFim:c,userId:e},success:function(){$("#addTaskForm").dialog("destroy"),$("#taskList tr").not(":first-child").empty()}}).done(function(a){var t=$.parseJSON(a);$("#typeDone").removeClass("activeTaskTypeDone"),$("#typeUndone").addClass("activeTaskTypeUndone");for(var i=0;i<t.length;i++)1!=t[i].taskStatus&&o.append("<tr id = "+t[i].id+"><td>"+t[i].taskName+"</td><td>"+t[i].desc+"</td><td>"+t[i].dataInicio+" "+t[i].horaInicio+":"+t[i].minutoInicio+"</td><td>"+t[i].dataFim+" "+t[i].horaFim+":"+t[i].minutoFim+"</td></tr>")})}),$("#taskList").on("dblclick","tr",function(){var a=$(this).attr("id"),t=$("input[name=taskId]"),i=$("#txtTaskName"),o=$("#txtTaskDesc"),e=$("#dataInicio"),d=$("#dataFim"),n=$("#horaInicio"),s=$("#minutoInicio"),h=$("#horaFim"),l=$("#minutoFim");$.ajax({url:"modules/MyTasks/php/editaTarefa.php",type:"POST",data:{taskId:a},success:function(a){var c=$.parseJSON(a);$("#btnAddTask span").html("Gravar"),$("#addTaskForm").dialog({modal:!0,show:{effect:"slideDown",duration:600},width:500});for(var r=0;r<c.length;r++)t.val(c[r].id),i.val(c[r].taskName),o.val(c[r].desc),e.val(c[r].dataInicio),d.val(c[r].dataFim),n.val(c[r].horaInicio),s.val(c[r].minutoInicio),h.val(c[r].horaFim),l.val(c[r].minutoFim)}})}),$("#horaInicio, #horaFim").append(function(){var a=1;for(a=1;24>=a;a++)$(this).append(9>=a?"<option>0"+a+"</option>":"<option>"+a+"</option>")}),$("#minutoInicio, #minutoFim").append(function(){var a=0;for(a=0;59>=a;a++)$(this).append(10>a?"<option>0"+a+"</option>":"<option>"+a+"</option>")}),$("#doneTask").on("click",function(){var a=0,i=[];o.hide(),$(".highlighted").each(function(){i[a]=$(this).attr("id"),a++}),i.length>0&&$("#doneDialog").dialog({resizable:!1,height:140,width:500,modal:!0,buttons:{Sim:function(){var a=0,i=[];$(".highlighted").each(function(){i[a]=$(this).attr("id"),$(this).removeClass("highlighted"),$(this).css("background","#00CC00"),$(this).addClass("done"),a++}),$.ajax({type:"POST",url:"modules/MyTasks/php/doneTask.php",data:{tasks:i},success:function(){$("#taskList tr").not(":first-child").empty(),t()}}),$(this).dialog("close")},Cancelar:function(){$(this).dialog("close")}}})}),$("#listDoneTasks").on("click",function(){o.hide(),$("#doneTask").hide(),$("#typeDone").addClass("activeTaskTypeDone"),$("#typeUndone").removeClass("activeTaskTypeUndone"),$("#taskList tr").not(":first-child").remove(),i()}),$("#listActiveTasks").on("click",function(){o.hide(),$("#doneTask").show(),$("#typeDone").removeClass("activeTaskTypeDone"),$("#typeUndone").addClass("activeTaskTypeUndone"),$("#taskList tr").not(":first-child").remove(),t()})});