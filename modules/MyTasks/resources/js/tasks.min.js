$(document).ready(function(){function i(){var e=$("input[name=txtTaskName]").val("");var t=$("textarea[name=txtTaskDesc]").val("");var n=$("#dataInicio").val("");var r=$("#dataFim").val("");var i=$("#horaInicio").val("");var s=$("#minutoInicio").val("");var o=$("#horaFim").val("");var u=$("#minutoFim").val("")}function s(){$.ajax({url:"modules/MyTasks/php/carregaTarefas.php",type:"POST",data:{userId:r},success:function(t){var n=$.parseJSON(t);for(var r=0;r<n.length;r++){if(n[r].taskStatus!=1){e.append("<tr id = "+n[r].id+">"+"<td>"+n[r].taskName+"</td>"+"<td>"+n[r].desc+"</td>"+"<td>"+n[r].dataInicio+" "+n[r].horaInicio+":"+n[r].minutoInicio+"</td>"+"<td>"+n[r].dataFim+" "+n[r].horaFim+":"+n[r].minutoFim+"</td>"+"</tr>")}}}})}function o(){$.ajax({url:"modules/MyTasks/php/carregaTarefas.php",type:"POST",data:{userId:r},success:function(t){var n=$.parseJSON(t);for(var r=0;r<n.length;r++){if(n[r].taskStatus==1){e.append("<tr id = "+n[r].id+" class = 'done'>"+"<td>"+n[r].taskName+"</td>"+"<td>"+n[r].desc+"</td>"+"<td>"+n[r].dataInicio+" "+n[r].horaInicio+":"+n[r].minutoInicio+"</td>"+"<td>"+n[r].dataFim+" "+n[r].horaFim+":"+n[r].minutoFim+"</td>"+"</tr>")}}}})}var e=$("#taskList");$("#deleteDialog").hide();$("#deleteDialogSelected").hide();$("#doneDialog").hide();$("#alreadyDoneDialog").hide();$("#addTaskForm").hide();$("#addGroupForm").hide();e.hide();$("#typeUndone").addClass("activeTaskTypeUndone");var t=$("#dataInicio").val();var n=$("#dataFim").val();var r=$("input[name=userId]").val();s();$("#dataInicio").datepicker({altFormat:"dd/mm/yyy",dateFormat:"dd/mm/yy",showOtherMonths:true,selectOtherMonths:true,changeMonth:true,changeYear:true});$("#dataFim").datepicker({altFormat:"dd/mm/yy",dateFormat:"dd/mm/yy",showOtherMonths:true,selectOtherMonths:true,changeMonth:true,changeYear:true});$(document).ajaxStart(function(){$(".loader").hide()});$(document).ajaxStop(function(){$(".loader").hide();e.show()});$("#addTask").on("click",function(){$("#btnAddTask span").html("Adicionar");$("input[name=taskId]").val("");i();$("#addTaskForm").dialog({modal:true,show:{effect:"slideDown",duration:600},width:500})});$("#btnCancelTaskForm").on("click",function(){$("#addTaskForm").dialog("destroy")});$(".taskList").on("click","tr:not(:first-child)",function(){if($(this).hasClass("highlighted")){$(this).removeClass("highlighted")}else if($(this).hasClass("done")){$(this).removeClass("done");$(this).addClass("highlighted2")}else if($(this).hasClass("highlighted2")){$(this).removeClass("highlighted2");$(this).addClass("done")}else{$(this).addClass("highlighted")}});$("#removeTask").on("click",function(){var e=0;var t=[];$(".highlighted, .highlighted2").each(function(){t[e]=$(this).attr("id");e++});if(t.length>0){$("#deleteDialog").dialog({resizable:false,height:140,width:500,modal:true,buttons:{Sim:function(){var e=0;var t=[];$(".highlighted, .highlighted2").each(function(){$(this).remove();t[e]=$(this).attr("id");e++});$.ajax({type:"POST",url:"modules/MyTasks/php/deletaTarefas.php",data:{tasks:t},success:function(e){}});$(this).dialog("close")},Cancelar:function(){$(this).dialog("close")}}})}else{$("#deleteDialogSelected").dialog({modal:true,buttons:{Ok:function(){$(this).dialog("close")}}})}});$("#btnAddTask").on("click",function(){var t=$("input[name=taskId]").val();var n=$("input[name=txtTaskName]").val();var i=$("textarea[name=txtTaskDesc]").val();var s=$("#dataInicio").val();var o=$("#dataFim").val();var u=$("#horaInicio").val();var a=$("#minutoInicio").val();var f=$("#horaFim").val();var l=$("#minutoFim").val();if(n==""){alert("Favor informe o nome da tarefa.")}else{$.ajax({type:"POST",url:"modules/MyTasks/php/addTask.php",data:{taskId:t,taskName:n,taskDesc:i,dataInicio:s,dataFim:o,horaInicio:u,minutoInicio:a,horaFim:f,minutoFim:l,userId:r},success:function(e){$("#addTaskForm").dialog("destroy");$("#taskList tr").not(":first-child").empty()}}).done(function(t){var n=$.parseJSON(t);$("#typeDone").removeClass("activeTaskTypeDone");$("#typeUndone").addClass("activeTaskTypeUndone");$("#doneTask").show();for(var r=0;r<n.length;r++){if(n[r].taskStatus!=1){e.append("<tr id = "+n[r].id+">"+"<td>"+n[r].taskName+"</td>"+"<td>"+n[r].desc+"</td>"+"<td>"+n[r].dataInicio+" "+n[r].horaInicio+":"+n[r].minutoInicio+"</td>"+"<td>"+n[r].dataFim+" "+n[r].horaFim+":"+n[r].minutoFim+"</td>"+"</tr>")}}})}});$("#taskList").on("dblclick","tr",function(){var e=$(this).attr("id");var t=$("input[name=taskId]");var n=$("#txtTaskName");var r=$("#txtTaskDesc");var i=$("#dataInicio");var s=$("#dataFim");var o=$("#horaInicio");var u=$("#minutoInicio");var a=$("#horaFim");var f=$("#minutoFim");$.ajax({url:"modules/MyTasks/php/editaTarefa.php",type:"POST",data:{taskId:e},success:function(e){var l=$.parseJSON(e);var c=false;$("#btnAddTask span").html("Gravar");$("#addTaskForm").dialog({modal:true,show:{effect:"slideDown",duration:600},width:500});for(var h=0;h<l.length;h++){t.val(l[h].id);n.val(l[h].taskName);r.val(l[h].desc);i.val(l[h].dataInicio);s.val(l[h].dataFim);o.val(l[h].horaInicio);u.val(l[h].minutoInicio);a.val(l[h].horaFim);f.val(l[h].minutoFim)}}})});$("#horaInicio, #horaFim").append(function(){var e=1;for(e=1;e<=24;e++){if(e<=9){$(this).append("<option>"+"0"+e+"</option>")}else{$(this).append("<option>"+e+"</option>")}}});$("#minutoInicio, #minutoFim").append(function(){var e=0;for(e=0;e<=59;e++){if(e<10){$(this).append("<option>"+"0"+e+"</option>")}else{$(this).append("<option>"+e+"</option>")}}});$("#doneTask").on("click",function(){var e=0;var t=[];$(".highlighted").each(function(){t[e]=$(this).attr("id");e++});if(t.length>0){$("#doneDialog").dialog({resizable:false,height:140,width:500,modal:true,buttons:{Sim:function(){var e=0;var t=[];$(".highlighted").each(function(){t[e]=$(this).attr("id");$(this).removeClass("highlighted");$(this).css("background","#00CC00");$(this).addClass("done");e++});$.ajax({type:"POST",url:"modules/MyTasks/php/doneTask.php",data:{tasks:t},success:function(e){$("#taskList tr").not(":first-child").empty();s()}});$(this).dialog("close")},Cancelar:function(){$("#taskList tr").not(":first-child").empty();s();$(this).dialog("close")}}})}});$("#listDoneTasks").on("click",function(){e.hide();$("#doneTask").hide();$("#typeDone").addClass("activeTaskTypeDone");$("#typeUndone").removeClass("activeTaskTypeUndone");$("#taskList tr").not(":first-child").remove();o()});$("#listActiveTasks").on("click",function(){e.hide();$("#doneTask").show();$("#typeDone").removeClass("activeTaskTypeDone");$("#typeUndone").addClass("activeTaskTypeUndone");$("#taskList tr").not(":first-child").remove();s()})})