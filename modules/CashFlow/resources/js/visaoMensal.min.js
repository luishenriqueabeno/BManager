$(document).ready(function(){function e(){var e=$("#anoSelect").val();n.empty(),d.empty(),r.empty(),$.ajax({type:"POST",url:"modules/CashFlow/php/loadExpenses.php",data:{ano:e,userId:c},success:function(e){$(n).append(e)}}),$.ajax({type:"POST",url:"modules/CashFlow/php/loadIncomes.php",data:{ano:e,userId:c},success:function(e){$(d).append(e)}}),$.ajax({type:"POST",url:"modules/CashFlow/php/loadSaldo.php",data:{ano:e,userId:c},success:function(e){$(r).append(e)}})}function a(){n.empty(),d.empty(),r.empty();var e="";$.ajax({type:"POST",url:"modules/CashFlow/php/loadExpenses.php",data:{ano:e,userId:c},success:function(e){$(n).append(e)}}),$.ajax({type:"POST",url:"modules/CashFlow/php/loadIncomes.php",data:{ano:e,userId:c},success:function(e){$(d).append(e)}}),$.ajax({type:"POST",url:"modules/CashFlow/php/loadSaldo.php",data:{ano:e,userId:c},success:function(e){$(r).append(e)}})}function t(){var e=(new Date).getFullYear();$.ajax({type:"POST",url:"modules/CashFlow/php/loadCategories.php",data:{userId:c,ano:e},success:function(e){for(var a=$.parseJSON(e),t=0;t<a.length;t++)1==a[t].categoryTypeId?o.append("<option value = "+a[t].id+">"+a[t].categoryName+"</option>"):s.append("<option value = "+a[t].id+">"+a[t].categoryName+"</option>")}})}var o=$("select[name=expenseCategory]"),s=$("select[name=incomeCategory]"),n=$("#listExpenses"),d=$("#listIncomes"),r=$("#tableSaldo");$("#addExpenseForm").hide(),$("#addIncomeForm").hide(),$("#addCategoryForm").hide(),$(".categoryMsgError").hide(),$(".displayError").hide(),$(".categoryMsgSuccess").hide(),$(".expenseAddSuccess").hide(),$(".incomeAddSuccess").hide(),$("#anoSelect").val((new Date).getFullYear()).attr("selected");var c=$("input[name=userId]").val();a(),t(),$("#data").datepicker({altFormat:"dd/mm/yyy",dateFormat:"dd/mm/yy",showOtherMonths:!0,selectOtherMonths:!0,changeMonth:!0,changeYear:!0}),$("#incomeDate").datepicker({altFormat:"dd/mm/yyy",dateFormat:"dd/mm/yy",showOtherMonths:!0,selectOtherMonths:!0,changeMonth:!0,changeYear:!0}),$("#txtIncomeValue").maskMoney({showSymbol:!0,symbol:"R$",decimal:",",thousands:"."}),$("#txtExpenseValue").maskMoney({showSymbol:!0,symbol:"R$",decimal:",",thousands:".",precision:2}),$(document).ajaxStart(function(){$(".loader").show()}),$(document).ajaxStop(function(){$(".loader").hide(),$(".expenseTitle").each(function(){var e=$(this).attr("title").split("_").join(" ");$(this).attr("title",e)}),$(".incomeTitle").each(function(){var e=$(this).attr("title").split("_").join(" ");$(this).attr("title",e)}),$(".incomeTitleCat").each(function(){var e=$(this).attr("title").split("_").join(" ");$(this).attr("title",e)}),$(".expenseTitleCat").each(function(){var e=$(this).attr("title").split("_").join(" ");$(this).attr("title",e)})}),$("#addExpense").on("click",function(){$("#formAddExpense")[0].reset(),$(".expenseAddSuccess").hide(),$(".displayError").hide(),$("#txtExpenseName").removeClass("redBorder"),$("#addExpenseForm").dialog({modal:!0,show:{effect:"slideDown",duration:600},width:500})}),$("#addIncome").on("click",function(){$("#formAddIncome")[0].reset(),$(".incomeAddSuccess").hide(),$(".displayError").hide(),$("#txtIncomeName").removeClass("redBorder"),$("#addIncomeForm").dialog({modal:!0,show:{effect:"slideDown",duration:600},width:500})}),$("#addCategory").on("click",function(){$("#formAddCategory")[0].reset(),$(".categoryMsgSuccess").hide(),$(".categoryMsgError").hide(),$(".displayError").hide(),$("#txtCategoryName").removeClass("redBorder"),$("#addCategoryForm").dialog({modal:!0,show:{effect:"slideDown",duration:600},width:500})}),$("#btnCancelExpenseForm").on("click",function(){$("#addExpenseForm").dialog("destroy")}),$("#btnCancelCategoryForm").on("click",function(){$("#addCategoryForm").dialog("destroy")}),$("#btnCancelIncomeForm").on("click",function(){$("#addIncomeForm").dialog("destroy")}),$("#anoSelect").change(function(){var e=$("#anoSelect").val();n.empty(),$.ajax({type:"POST",url:"modules/CashFlow/php/loadExpenses.php",data:{ano:e,userId:c},success:function(e){$(n).append(e)}})}),$("#anoSelect").change(function(){var e=$("#anoSelect").val();d.empty(),$.ajax({type:"POST",url:"modules/CashFlow/php/loadIncomes.php",data:{ano:e,userId:c},success:function(e){$(d).append(e)}})}),$("#anoSelect").change(function(){var e=$("#anoSelect").val();r.empty(),$.ajax({type:"POST",url:"modules/CashFlow/php/loadSaldo.php",data:{ano:e,userId:c},success:function(e){$(r).append(e)}})}),$("#anoSelect").change(function(){var e=$("#anoSelect").val();o.empty(),s.empty(),$.ajax({type:"POST",url:"modules/CashFlow/php/loadCategories.php",data:{ano:e,userId:c},success:function(e){for(var a=$.parseJSON(e),t=0;t<a.length;t++)1==a[t].categoryTypeId?o.append("<option value = "+a[t].id+">"+a[t].categoryName+"</option>"):s.append("<option value = "+a[t].id+">"+a[t].categoryName+"</option>")}})}),$("#btnAddExpense").on("click",function(){var a=$("#txtExpenseName").val(),t=$("#anoSelect").val(),o=$("#txtExpenseValue").val(),s=$("select[name=expenseCategory]").find(":selected").val();""==a?($("#txtExpenseName").addClass("redBorder"),$(".expenseAddSuccess").hide(),$(".displayError").show()):$.ajax({type:"POST",url:"modules/CashFlow/php/addExpense.php",data:{userId:c,expenseName:a,expenseValue:o,ano:t,category:s},success:function(a){1==a&&($(".expenseAddSuccess").show(),$(".displayError").hide(),e())}})}),$("#btnAddIncome").on("click",function(){var a=$("#txtIncomeName").val(),t=$("#anoSelect").val(),o=$("#txtIncomeValue").val(),s=$("select[name=incomeCategory]").find(":selected").val();""==a?($("#txtIncomeName").addClass("redBorder"),$(".incomeAddSuccess").hide(),$(".displayError").show()):$.ajax({type:"POST",url:"modules/CashFlow/php/addIncome.php",data:{userId:c,incomeName:a,incomeValue:o,ano:t,category:s},success:function(a){1==a&&($(".incomeAddSuccess").show(),$(".displayError").hide(),e())}})}),$("#btnAddCategory").on("click",function(){var e=$("#txtCategoryName").val(),a=$("input[name=categoryType]:checked").val(),t=$("#anoSelect").val();""==e?($("#txtCategoryName").addClass("redBorder"),$(".categoryMsgSuccess").hide(),$(".categoryMsgError").hide(),$(".displayError").show()):$.ajax({type:"POST",url:"modules/CashFlow/php/addCategory.php",data:{userId:c,categoryName:e,categoryTypeId:a,ano:t},success:function(e){if(2==e)$(".categoryMsgError").show(),$(".categoryMsgSuccess").hide(),$(".displayError").hide();else{o.empty(),s.empty(),$(".categoryMsgError").hide(),$(".categoryMsgSuccess").show(),$(".displayError").hide();for(var a=$.parseJSON(e),t=0;t<a.length;t++)1==a[t].categoryTypeId?o.append("<option value = "+a[t].id+">"+a[t].categoryName+"</option>"):s.append("<option value = "+a[t].id+">"+a[t].categoryName+"</option>")}}})}),$("#listIncomes, #listExpenses, #tableSaldo").on("click","td:not(.total, :first-child)",function(){var a=$(this).text(),t=$(this).parent().attr("id"),o=$(this).attr("class"),s=$("#anoSelect").val();$(this).addClass("celulaEmEdicao"),$(this).html("<input type='text' value='"+a+"' />"),$(this).children().first().focus(),$(this).children().first().keypress(function(a){if(13==a.which){var n=$(this).val();$(this).parent().text(n),$(this).parent().removeClass("celulaEmEdicao"),$.ajax({url:"modules/CashFlow/php/updateTableField.php",data:{novoConteudo:n,rowId:t,month:o,userId:c,ano:s},type:"POST",success:function(){e()}})}}),$(this).children().first().blur(function(){$(this).parent().text(a),$(this).parent().removeClass("celulaEmEdicao")})})});