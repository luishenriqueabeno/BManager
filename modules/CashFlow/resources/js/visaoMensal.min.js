$(document).ready(function(){function o(){var e=$("#anoSelect").val();n.empty();r.empty();i.empty();$.ajax({type:"POST",url:"modules/CashFlow/php/loadExpenses.php",data:{ano:e,userId:s},success:function(e){$(n).append(e)}});$.ajax({type:"POST",url:"modules/CashFlow/php/loadIncomes.php",data:{ano:e,userId:s},success:function(e){$(r).append(e)}});$.ajax({type:"POST",url:"modules/CashFlow/php/loadSaldo.php",data:{ano:e,userId:s},success:function(e){$(i).append(e)}})}function u(){n.empty();r.empty();i.empty();var e="";$.ajax({type:"POST",url:"modules/CashFlow/php/loadExpenses.php",data:{ano:e,userId:s},success:function(e){$(n).append(e)}});$.ajax({type:"POST",url:"modules/CashFlow/php/loadIncomes.php",data:{ano:e,userId:s},success:function(e){$(r).append(e)}});$.ajax({type:"POST",url:"modules/CashFlow/php/loadSaldo.php",data:{ano:e,userId:s},success:function(e){$(i).append(e)}})}function a(){var n=(new Date).getFullYear();$.ajax({type:"POST",url:"modules/CashFlow/php/loadCategories.php",data:{userId:s,ano:n},success:function(n){var r=$.parseJSON(n);var i="";var s="";for(var o=0;o<r.length;o++){if(r[o].categoryTypeId==1){i+="<option value = "+r[o].id+">"+r[o].categoryName+"</option>"}else{s+="<option value = "+r[o].id+">"+r[o].categoryName+"</option>"}}e.append(i);t.append(s)}})}var e=$("select[name=expenseCategory]");var t=$("select[name=incomeCategory]");var n=$("#listExpenses");var r=$("#listIncomes");var i=$("#tableSaldo");$("#addExpenseForm").hide();$("#addIncomeForm").hide();$("#addCategoryForm").hide();$(".categoryMsgError").hide();$(".displayError").hide();$(".categoryMsgSuccess").hide();$(".expenseAddSuccess").hide();$(".incomeAddSuccess").hide();$("#anoSelect").val((new Date).getFullYear()).attr("selected");var s=$("input[name=userId]").val();u();a();$("#data").datepicker({altFormat:"dd/mm/yyy",dateFormat:"dd/mm/yy",showOtherMonths:true,selectOtherMonths:true,changeMonth:true,changeYear:true});$("#incomeDate").datepicker({altFormat:"dd/mm/yyy",dateFormat:"dd/mm/yy",showOtherMonths:true,selectOtherMonths:true,changeMonth:true,changeYear:true});$("#txtIncomeValue").maskMoney({showSymbol:true,symbol:"R$",decimal:",",thousands:"."});$("#txtExpenseValue").maskMoney({showSymbol:true,symbol:"R$",decimal:",",thousands:".",precision:2});$(document).ajaxStart(function(){$(".loader").show()});$(document).ajaxStop(function(){$(".loader").hide();$(".expenseTitle").each(function(){var e=$(this).attr("title").split("_").join(" ");$(this).attr("title",e)});$(".incomeTitle").each(function(){var e=$(this).attr("title").split("_").join(" ");$(this).attr("title",e)});$(".incomeTitleCat").each(function(){var e=$(this).attr("title").split("_").join(" ");$(this).attr("title",e)});$(".expenseTitleCat").each(function(){var e=$(this).attr("title").split("_").join(" ");$(this).attr("title",e)})});$("#addExpense").on("click",function(){$("#formAddExpense")[0].reset();$(".expenseAddSuccess").hide();$(".displayError").hide();$("#txtExpenseName").removeClass("redBorder");$("#txtExpenseName").removeClass("greenBorder");$("#addExpenseForm").dialog({modal:true,show:{effect:"slideDown",duration:600},width:500})});$("#addIncome").on("click",function(){$("#formAddIncome")[0].reset();$(".incomeAddSuccess").hide();$(".displayError").hide();$("#txtIncomeName").removeClass("redBorder");$("#txtIncomeName").removeClass("greenBorder");$("#addIncomeForm").dialog({modal:true,show:{effect:"slideDown",duration:600},width:500})});$("#addCategory").on("click",function(){$("#formAddCategory")[0].reset();$(".categoryMsgSuccess").hide();$(".categoryMsgError").hide();$(".displayError").hide();$("#txtCategoryName").removeClass("redBorder");$("#addCategoryForm").dialog({modal:true,show:{effect:"slideDown",duration:600},width:500})});$("#btnCancelExpenseForm").on("click",function(){$("#addExpenseForm").dialog("destroy")});$("#btnCancelCategoryForm").on("click",function(){$("#addCategoryForm").dialog("destroy")});$("#btnCancelIncomeForm").on("click",function(){$("#addIncomeForm").dialog("destroy")});$("#anoSelect").change(function(){var e=$("#anoSelect").val();n.empty();$.ajax({type:"POST",url:"modules/CashFlow/php/loadExpenses.php",data:{ano:e,userId:s},success:function(e){$(n).append(e)}})});$("#anoSelect").change(function(){var e=$("#anoSelect").val();r.empty();$.ajax({type:"POST",url:"modules/CashFlow/php/loadIncomes.php",data:{ano:e,userId:s},success:function(e){$(r).append(e)}})});$("#anoSelect").change(function(){var e=$("#anoSelect").val();i.empty();$.ajax({type:"POST",url:"modules/CashFlow/php/loadSaldo.php",data:{ano:e,userId:s},success:function(e){$(i).append(e)}})});$("#anoSelect").change(function(){var n=$("#anoSelect").val();e.empty();t.empty();$.ajax({type:"POST",url:"modules/CashFlow/php/loadCategories.php",data:{ano:n,userId:s},success:function(n){var r=$.parseJSON(n);var i="";var s="";for(var o=0;o<r.length;o++){if(r[o].categoryTypeId==1){i+="<option value = "+r[o].id+">"+r[o].categoryName+"</option>"}else{s+="<option value = "+r[o].id+">"+r[o].categoryName+"</option>"}}e.append(i);t.append(s)}})});$("#txtExpenseName").keyup(function(){if($(this).val()==""){$(this).removeClass("greenBorder");$(this).addClass("redBorder")}else{$(this).addClass("greenBorder");$(this).removeClass("redBorder")}});$("#txtExpenseName").focusout(function(){if($(this).val()==""){$(this).removeClass("greenBorder");$(this).addClass("redBorder")}else{$(this).addClass("greenBorder");$(this).removeClass("redBorder")}});$("#txtIncomeName").keyup(function(){if($(this).val()==""){$(this).removeClass("greenBorder");$(this).addClass("redBorder")}else{$(this).addClass("greenBorder");$(this).removeClass("redBorder")}});$("#txtIncomeName").focusout(function(){if($(this).val()==""){$(this).removeClass("greenBorder");$(this).addClass("redBorder")}else{$(this).addClass("greenBorder");$(this).removeClass("redBorder")}});$("#btnAddExpense").on("click",function(){var e=$("#txtExpenseName").val();var t=$("#anoSelect").val();var n=$("#txtExpenseValue").val();var r=$("select[name=expenseCategory]").find(":selected").val();if($("#txtExpenseName").hasClass("redBorder")){$(".expenseAddSuccess").hide();$(".displayError").show()}else if(r==""){alert("Favor informe ao menos uma categoria");$(".expenseAddSuccess").hide();$(".displayError").hide()}else{$.ajax({type:"POST",url:"modules/CashFlow/php/addExpense.php",data:{userId:s,expenseName:e,expenseValue:n,ano:t,category:r},success:function(e){if(e==1){$("#formAddExpense")[0].reset();$("#txtExpenseName").removeClass("greenBorder");$(".expenseAddSuccess").show();$(".displayError").hide();o()}}})}});$("#btnAddIncome").on("click",function(){var e=$("#txtIncomeName").val();var t=$("#anoSelect").val();var n=$("#txtIncomeValue").val();var r=$("select[name=incomeCategory]").find(":selected").val();if(e==""){$("#txtIncomeName").addClass("redBorder");$(".incomeAddSuccess").hide();$(".displayError").show()}else if(r==""){alert("Favor informe ao menos uma categoria");$(".incomeAddSuccess").hide();$(".displayError").hide()}else{$.ajax({type:"POST",url:"modules/CashFlow/php/addIncome.php",data:{userId:s,incomeName:e,incomeValue:n,ano:t,category:r},success:function(e){$("#formAddIncome")[0].reset();$("#txtIncomeName").removeClass("greenBorder");if(e==1){$(".incomeAddSuccess").show();$(".displayError").hide();o()}}})}});$("#btnAddCategory").on("click",function(){var n=$("#txtCategoryName").val();var r=$("input[name=categoryType]:checked").val();var i=$("#anoSelect").val();if(n==""){$("#txtCategoryName").addClass("redBorder");$(".categoryMsgSuccess").hide();$(".categoryMsgError").hide();$(".displayError").show()}else{$.ajax({type:"POST",url:"modules/CashFlow/php/addCategory.php",data:{userId:s,categoryName:n,categoryTypeId:r,ano:i},success:function(n){if(n==2){$(".categoryMsgError").show();$(".categoryMsgSuccess").hide();$(".displayError").hide()}else{e.empty();t.empty();$(".categoryMsgError").hide();$(".categoryMsgSuccess").show();$(".displayError").hide();var r=$.parseJSON(n);var i="";var s="";for(var o=0;o<r.length;o++){if(r[o].categoryTypeId==1){i+="<option value = "+r[o].id+">"+r[o].categoryName+"</option>"}else{s+="<option value = "+r[o].id+">"+r[o].categoryName+"</option>"}}e.append(i);t.append(s)}}})}});$("#listIncomes, #listExpenses, #tableSaldo").on("click","td:not(.total, :first-child)",function(){var e=$(this).text();var t=$(this).parent().attr("id");var n=$(this).attr("class");var r=$("#anoSelect").val();$(this).addClass("celulaEmEdicao");$(this).html("<input type='text' value='"+e+"' />");$(this).children().first().focus();$(this).children().first().keypress(function(e){if(e.which==13){var i=$(this).val();$(this).parent().text(i);$(this).parent().removeClass("celulaEmEdicao");$.ajax({url:"modules/CashFlow/php/updateTableField.php",data:{novoConteudo:i,rowId:t,month:n,userId:s,ano:r},type:"POST",success:function(e){o()}})}});$(this).children().first().blur(function(){$(this).parent().text(e);$(this).parent().removeClass("celulaEmEdicao")})})})